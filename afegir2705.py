# A introduir al pipeline DataReestructure
dataframe_a_transformar['datetime'] = pd.to_datetime(dataframe_a_transformar[['year', 'month', 'day', 'hour']])
from datetime import date
import holidays
vacances = holidays.country_holidays('ES', subdiv  = 'CT')

dates_vacances = [
    "01/01/2019",
    "05/01/2023",
    "19/04/2019",
    "22/04/2019",
    "01/05/2019",
    "10/06/2023",
    "24/06/2019",
    "15/08/2019",
    "11/09/2019",
    "24/09/2019",
    "12/10/2019",
    "01/11/2019",
    "06/12/2019",
    "08/12/2019",
    "25/12/2019",
    "26/12/2019",
    
    "31/12/2019",
    "01/01/2019",
    "05/01/2023",
    "19/04/2019",
    "22/04/2019",
    "01/05/2019",
    "10/06/2023",
    "24/06/2019",
    "15/08/2019",
    "11/09/2019",
    "24/09/2019",
    "12/10/2019",
    "01/11/2019",
    "06/12/2019",
    "08/12/2019",
    "25/12/2019",
    "26/12/2019",
    "31/12/2019",

    "01/01/2020",  
    "06/01/2020",
    "10/04/2020",  
    "13/04/2020",  
    "01/05/2020",  
    "01/06/2020",  
    "24/06/2020", 
    "15/08/2020",  
    "11/09/2020",  
    "24/09/2020",  
    "12/10/2020",  
    "08/12/2020",  
    "25/12/2020",  
    "26/12/2020",  


    "01/01/2021",  
    "06/01/2021",  
    "02/04/2021",  
    "05/04/2021",  
    "01/05/2021",  
    "24/06/2021", 
    "11/09/2021",  
    "12/10/2021", 
    "01/11/2021",  
    "06/12/2021",  
    "08/12/2021",  
    "25/12/2021", 

    "01/01/2022",  
    "06/01/2022",  
    "15/04/2022",  
    "18/04/2022",  
    "06/06/2022",  
    "24/06/2022", 
    "15/08/2022", 
    "24/09/2022",  
    "26/09/2022",  
    "12/10/2022", 
    "01/11/2022",  
    "06/12/2022",  
    "08/12/2022",  
    "26/12/2022", 

    "06/01/2023",  
    "07/04/2023",  
    "10/04/2023",  
    "01/05/2023", 
    "05/06/2023", 
    "24/06/2023",  
    "15/08/2023",  
    "11/09/2023",  
    "25/09/2023",  
    "12/10/2023",  
    "01/11/2023",  
    "06/12/2023",
    "08/12/2023",  
    "25/12/2023",  
    "26/12/2023",  
]

dates_curses = [
    "30/12/2019",
    "10/03/2019",
    "10/02/2019",
    "07/04/2019",

    "19/06/2021",
    "24/04/2022",
    "08/05/2022",
    "09/10/2022",
    "15/10/2022",
    "06/12/2022",
    "17/12/2022",
    "18/12/2022"



    "22/01/2023",
    "19/02/2023",
    "05/03/2023",
    "18/03/2023",
    "18/03/2023",
    "18/03/2023",
    "19/03/2023",
    "16/04/2023",
    "07/05/2023",
    "07/05/2023"

]


for festiu in dates_vacances:
    date = datetime.strptime(festiu, "%d/%m/%Y").date()
    vacances[date] = "Festiu "

for cursa in dates_curses:
    date = datetime.strptime(festiu, "%d/%m/%Y").date()
    vacances[date] = "Cursa "
dataframe_a_transformar['festiu'] = dataframe_a_transformar['datetime'].dt.date.apply(lambda x: x in vacances).astype(int)

